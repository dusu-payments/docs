<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_mobilemoneypayouts_old">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="mobile-money-pay-outs-api">Mobile Money Pay Outs API</h1>

<h2 id="check-mobile-money-balance-withdrawable">Check Mobile Money Balance(Withdrawable)</h2>
<pre class="highlight ruby"><code><span class="no">Live</span> <span class="no">URL</span>
<span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">check_mobile_money_withdrawable_balance</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="p">.</span><span class="nf">json</span> 

<span class="no">Sandbox</span> <span class="no">URl</span>
<span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">sandbox</span><span class="p">.</span><span class="nf">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">check_mobile_money_withdrawable_balance</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="p">.</span><span class="nf">json</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nv">$param3</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">,</span> <span class="p">(</span><span class="nv">$param1</span><span class="o">.</span><span class="nv">$param2</span><span class="p">),</span> <span class="nv">$mackey</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight json"><code><span class="err">Example</span><span class="w"> </span><span class="err">Response(.json)</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"Response"</span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="nt">"merchant_id"</span><span class="p">:</span><span class="s2">"1001"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">5000</span><span class="p">,</span><span class="w">
   </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="w">
   </span><span class="s2">"status"</span><span class="err">:</span><span class="s2">"true/false"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"message"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code>Example Response(.xml)

<span class="nt">&lt;Response&gt;</span>
  <span class="nt">&lt;merchant_id&gt;</span>1001<span class="nt">&lt;/merchant_id&gt;</span>
  <span class="nt">&lt;amount&gt;</span>5000<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;currency&gt;</span>UGX<span class="nt">&lt;/currency&gt;</span>
  <span class="nt">&lt;status&gt;</span>true/false<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;message&gt;&lt;/message&gt;</span>
<span class="nt">&lt;/Response&gt;</span> 
</code></pre>

<aside class="notice">check_mobile_money_withdrawable_balance</aside>

<p>This API allows you to check how much you can withdraw/payout through mobile money from your merchant account.</p>

<table><thead>
<tr>
<th>URL-Parameters</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">param1</code></td>
<td>Replace this with your  <code class="prettyprint">MerchantId</code></td>
<td>1001</td>
</tr>
<tr>
<td><code class="prettyprint">param2</code></td>
<td>Replace this with UNIX Timestamp <code class="prettyprint">(Integer)</code></td>
<td>1460546650</td>
</tr>
<tr>
<td><code class="prettyprint">param3</code></td>
<td>Replace this with Hash/Token <code class="prettyprint">(String)</code></td>
<td>hash_hmac(&lsquo;sha1&rsquo;, JOIN_STRING(param1,param2), mackey)</td>
</tr>
</tbody></table>

<p><b>Note:</b><br>
- The URLs end in <code class="prettyprint">.json</code><br>
- You can also use a <code class="prettyprint">.xml</code> extension to receive results in XML format.<br></p>

<h2 id="withdraw-mobile-money-balance">Withdraw Mobile Money Balance</h2>
<pre class="highlight ruby"><code><span class="no">Live</span> <span class="no">URL</span>
<span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">withdraw_mobile_money_withdrawable_balance</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="o">/</span><span class="n">param5</span><span class="o">/</span><span class="n">param6</span><span class="p">.</span><span class="nf">json</span> 

<span class="no">Sandbox</span> <span class="no">URl</span>
<span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">sandbox</span><span class="p">.</span><span class="nf">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">withdraw_mobile_money_withdrawable_balance</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="o">/</span><span class="n">param5</span><span class="o">/</span><span class="n">param6</span><span class="p">.</span><span class="nf">json</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nv">$param6</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">,</span> <span class="p">(</span><span class="nv">$param1</span> <span class="o">.</span> <span class="nv">$param2</span> <span class="o">.</span> <span class="nv">$param3</span> <span class="o">.</span> <span class="nv">$param4</span> <span class="o">.</span> <span class="nv">$param5</span><span class="p">),</span> <span class="nv">$mackey</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight json"><code><span class="err">Example</span><span class="w"> </span><span class="err">Response(.json)</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"Response"</span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="nt">"external_reference"</span><span class="p">:</span><span class="s2">"25591"</span><span class="w">
   </span><span class="s2">"withdraw_request_id"</span><span class="err">:</span><span class="s2">"38"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"merchant_id"</span><span class="p">:</span><span class="s2">"1001"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">5000</span><span class="p">,</span><span class="w">
   </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="w">
   </span><span class="s2">"status"</span><span class="err">:</span><span class="s2">"true/false"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"message"</span><span class="p">:</span><span class="s2">"Successfully"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"new_balance"</span><span class="p">:</span><span class="s2">"23000"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"amount_sent"</span><span class="p">:</span><span class="s2">"20000"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"currency_sent"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"charge_amount"</span><span class="p">:</span><span class="s2">"1500"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"charge_currency"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="p">,</span><span class="w">
  </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code>Example Response(.xml)

<span class="nt">&lt;Response&gt;</span>
  <span class="nt">&lt;withdraw_request_id&gt;</span>38<span class="nt">&lt;/withdraw_request_id&gt;</span>
  <span class="nt">&lt;external_reference&gt;</span>25591<span class="nt">&lt;/external_reference&gt;</span>
  <span class="nt">&lt;merchant_id&gt;</span>1001<span class="nt">&lt;/merchant_id&gt;</span>
  <span class="nt">&lt;amount&gt;</span>5000<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;currency&gt;</span>UGX<span class="nt">&lt;/currency&gt;</span>
  <span class="nt">&lt;status&gt;</span>true/false<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;message&gt;</span>Successfully<span class="nt">&lt;/message&gt;</span>
  <span class="nt">&lt;new_balance&gt;</span>23000<span class="nt">&lt;/new_balance&gt;</span>
  <span class="nt">&lt;amount_sent&gt;</span>20000<span class="nt">&lt;/amount_sent&gt;</span>
  <span class="nt">&lt;currency_sent&gt;</span>UGX<span class="nt">&lt;/currency_sent&gt;</span>
  <span class="nt">&lt;charge_amount&gt;</span>1500<span class="nt">&lt;/charge_amount&gt;</span>
  <span class="nt">&lt;charge_currency&gt;</span>UGX<span class="nt">&lt;/charge_currency&gt;</span>
<span class="nt">&lt;/Response&gt;</span>
</code></pre>

<aside class="notice">withdraw_mobile_money_withdrawable_balance<br><br>
    Please check <br><b>withdraw_mobile_money_withdrawable_balance_v1</b><br> that follows below to reduce currency conversion charges
</aside>

<p>This API allows you to withdraw/payout your mobile-money-withdrawable-balance from your merchant account.</p>

<table><thead>
<tr>
<th>URL-Parameters</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">param1</code></td>
<td>Replace this with your  <code class="prettyprint">MerchantId</code></td>
<td>1001</td>
</tr>
<tr>
<td><code class="prettyprint">param2</code></td>
<td>Amount in Merchant Account Currency<code class="prettyprint">(Integer)</code></td>
<td>20000</td>
</tr>
<tr>
<td><code class="prettyprint">param3</code></td>
<td>AccountNumber/Phone <code class="prettyprint">(String)</code></td>
<td>256704543171<br> Supported Phone-Country-Codes = [256,254]</td>
</tr>
<tr>
<td><code class="prettyprint">param4</code></td>
<td>AccountHolder Name <code class="prettyprint">(String)</code></td>
<td>customer1</td>
</tr>
<tr>
<td><code class="prettyprint">param5</code></td>
<td>UNIX Timestamp <code class="prettyprint">(Integer)</code></td>
<td>1460546650</td>
</tr>
<tr>
<td><code class="prettyprint">param6</code></td>
<td>Replace this with Hash/Token <code class="prettyprint">(String)</code></td>
<td>hash_hmac(&#39;sha1&rsquo;, JOIN_STRING(param1,param2), mackey)</td>
</tr>
</tbody></table>

<p><b>Note:</b><br>
- The URLs end in <code class="prettyprint">.json</code><br>
- You can also use a <code class="prettyprint">.xml</code> extension to receive results in XML format.<br></p>

<h2 id="withdraw-mobile-money-balance-v1">Withdraw Mobile Money Balance V1</h2>
<pre class="highlight ruby"><code><span class="no">Live</span> <span class="no">URL</span>
<span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">withdraw_mobile_money_withdrawable_balance_v1</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="o">/</span><span class="n">param5</span><span class="o">/</span><span class="n">param6</span><span class="p">.</span><span class="nf">json</span> 

<span class="no">Sandbox</span> <span class="no">URl</span>
<span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">sandbox</span><span class="p">.</span><span class="nf">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">withdraw_mobile_money_withdrawable_balance_v1</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="o">/</span><span class="n">param5</span><span class="o">/</span><span class="n">param6</span><span class="p">.</span><span class="nf">json</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nv">$param6</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">,</span> <span class="p">(</span><span class="nv">$param1</span> <span class="o">.</span> <span class="nv">$param2</span> <span class="o">.</span> <span class="nv">$param3</span> <span class="o">.</span> <span class="nv">$param4</span> <span class="o">.</span> <span class="nv">$param5</span><span class="p">),</span> <span class="nv">$mackey</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight json"><code><span class="err">Example</span><span class="w"> </span><span class="err">Response(.json)</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"Response"</span><span class="p">:</span><span class="w">
  </span><span class="p">{</span><span class="w">
   </span><span class="nt">"external_reference"</span><span class="p">:</span><span class="s2">"25591"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"withdraw_request_id"</span><span class="p">:</span><span class="s2">"38"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"merchant_id"</span><span class="p">:</span><span class="s2">"1001"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"amount"</span><span class="p">:</span><span class="mi">5000</span><span class="p">,</span><span class="w">
   </span><span class="nt">"currency"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"true/false"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"message"</span><span class="p">:</span><span class="s2">"Successfully"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"new_balance"</span><span class="p">:</span><span class="s2">"23000"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"amount_sent"</span><span class="p">:</span><span class="s2">"20000"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"currency_sent"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"charge_amount"</span><span class="p">:</span><span class="s2">"1500"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"charge_currency"</span><span class="p">:</span><span class="s2">"UGX"</span><span class="p">,</span><span class="w">
  </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code>Example Response(.xml)

<span class="nt">&lt;Response&gt;</span>
  <span class="nt">&lt;withdraw_request_id&gt;</span>38<span class="nt">&lt;/withdraw_request_id&gt;</span>
  <span class="nt">&lt;external_reference&gt;</span>25591<span class="nt">&lt;/external_reference&gt;</span>
  <span class="nt">&lt;merchant_id&gt;</span>1001<span class="nt">&lt;/merchant_id&gt;</span>
  <span class="nt">&lt;amount&gt;</span>5000<span class="nt">&lt;/amount&gt;</span>
  <span class="nt">&lt;currency&gt;</span>UGX<span class="nt">&lt;/currency&gt;</span>
  <span class="nt">&lt;status&gt;</span>true/false<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;message&gt;</span>Successfully<span class="nt">&lt;/message&gt;</span>
  <span class="nt">&lt;new_balance&gt;</span>23000<span class="nt">&lt;/new_balance&gt;</span>
  <span class="nt">&lt;amount_sent&gt;</span>20000<span class="nt">&lt;/amount_sent&gt;</span>
  <span class="nt">&lt;currency_sent&gt;</span>UGX<span class="nt">&lt;/currency_sent&gt;</span>
  <span class="nt">&lt;charge_amount&gt;</span>1500<span class="nt">&lt;/charge_amount&gt;</span>
  <span class="nt">&lt;charge_currency&gt;</span>UGX<span class="nt">&lt;/charge_currency&gt;</span>
<span class="nt">&lt;/Response&gt;</span>
</code></pre>

<aside class="notice">withdraw_mobile_money_withdrawable_balance_v1<br><br>
    Please use this for payouts incase you are aware of the exact amount in the target MobileMoney Operator currency
</aside>

<p>This API allows you to withdraw/payout your mobile-money-withdrawable-balance from your merchant account to the mobile money number such that the target gets the exact intended money in their currency</p>

<p><b>i.e</b>
<p>
If i request to payout amount of 100 to 254704543171, The 100 will be expected/assumed to be in KES since the operator with country code 254 is Kenya and expects KES</p></p>

<p>
Therefore (100 + Charge) will be debited off your merchant account But this time the customer will receive exactly 100KES
</p>

<p>
This second API method is recommended if you are aware of the amount you want to payout your customer in the mobile money operator&rsquo;s currency.
</p>

<table><thead>
<tr>
<th>URL-Parameters</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">param1</code></td>
<td>Replace this with your  <code class="prettyprint">MerchantId</code></td>
<td>1001</td>
</tr>
<tr>
<td><code class="prettyprint">param2</code></td>
<td>Amount in mobile money operator&rsquo;s currency. Currency<code class="prettyprint">(Integer)</code></td>
<td>100 where it is 100KES if sending to 254704543171</td>
</tr>
<tr>
<td><code class="prettyprint">param3</code></td>
<td>AccountNumber/Phone <code class="prettyprint">(String)</code></td>
<td>256704543171<br> Supported Phone-Country-Codes = [256,254]</td>
</tr>
<tr>
<td><code class="prettyprint">param4</code></td>
<td>AccountHolder Name <code class="prettyprint">(String)</code></td>
<td>customer1</td>
</tr>
<tr>
<td><code class="prettyprint">param5</code></td>
<td>UNIX Timestamp <code class="prettyprint">(Integer)</code></td>
<td>1460546650</td>
</tr>
<tr>
<td><code class="prettyprint">param6</code></td>
<td>Replace this with Hash/Token <code class="prettyprint">(String)</code></td>
<td>hash_hmac(&#39;sha1&rsquo;, JOIN_STRING(param1,param2), mackey)</td>
</tr>
</tbody></table>

<p><b>Note:</b><br>
- The URLs end in <code class="prettyprint">.json</code><br></p>

<h2 id="check-mobile-money-payout-status">Check Mobile Money Payout Status</h2>
<pre class="highlight ruby"><code><span class="no">Live</span> <span class="no">URL</span>
<span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">check_mobile_money_withdrawable_status</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="p">.</span><span class="nf">json</span> 

<span class="no">Sandbox</span> <span class="no">URl</span>
<span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">sandbox</span><span class="p">.</span><span class="nf">dusupay</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">merchants</span><span class="o">/</span><span class="n">check_mobile_money_withdrawable_status</span><span class="o">/</span><span class="n">param1</span><span class="o">/</span><span class="n">param2</span><span class="o">/</span><span class="n">param3</span><span class="o">/</span><span class="n">param4</span><span class="p">.</span><span class="nf">json</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nv">$param4</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha1'</span><span class="p">,</span> <span class="p">(</span><span class="nv">$param1</span> <span class="o">.</span> <span class="nv">$param2</span> <span class="o">.</span> <span class="nv">$param3</span><span class="p">),</span> <span class="nv">$mackey</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>

<aside class="notice">check_mobile_money_withdrawable_status<br><br>
    Returns the status of the payout transaction. Use this to check for statuses incase the transaction is still `PENDING`
</aside>

<table><thead>
<tr>
<th>URL-Parameters</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">param1</code></td>
<td><code class="prettyprint">withdraw_request_id</code> that you received when you requested a payout</td>
<td>72</td>
</tr>
<tr>
<td><code class="prettyprint">param2</code></td>
<td><code class="prettyprint">merchant_id</code> Your Merchant ID</td>
<td>1000</td>
</tr>
<tr>
<td><code class="prettyprint">param3</code></td>
<td>UNIX <code class="prettyprint">Timestamp</code> <code class="prettyprint">(Integer)</code></td>
<td>1460546650</td>
</tr>
<tr>
<td><code class="prettyprint">param4</code></td>
<td>Replace this with Hash/Token <code class="prettyprint">(String)</code></td>
<td>hash_hmac(&#39;sha1&rsquo;, JOIN_STRING(param1,param2,param3), mackey)</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
